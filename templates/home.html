<!DOCTYPE html>
<html lang="en" style="height:95%;">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>YAAP</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/google/code-prettify@master/styles/sons-of-obsidian.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
	<style>
        body {
          background-color: #121212;
          color: #e0e0e0;
          font-family: sans-serif;
          margin: 0;
          padding: 0;
		  height: 100%;
        }
		.container {
			height: 95%;
		}
    
        .chat-container {
		  display: flex;
		  height: 85%;
		  flex-direction: column;
          margin: 50px auto;
          background-color: #1e1e1e;
          border-radius: 8px;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
          overflow: hidden;
        }
    
        .chat-header {
          background-color: #252526;
          padding: 10px;
          border-bottom: 1px solid #333;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
		.chat-form {
		  display: flex;
		  align-items: center;
		  justify-content: center;

		}

		.chat-area {
		  overflow: auto;
		  flex: 1;
		  margin-top: auto;
		  white-space: normal;
		}
    
        .chat-input {
          width: 70%;
          padding: 10px;
		  margin: 10px;
          font-size: 16px;
          border: none;
          background-color: #333;
          color: #e0e0e0;
          border-radius: 4px;
          outline: none;
        }
    
        .chat-send {
          background-color: #444;
          color: #e0e0e0;
          padding: 10px 15px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: 16px;
        }
		#mode-indicator {
          padding: 10px 15px;
          cursor: pointer;
          font-size: 16px;
		}
    
        .chat-messages {
          padding: 10px;
          height: 200px;
          overflow-y: scroll;
          background-color: #1e1e1e;
          border-top: 1px solid #333;
        }
    
        .chat-message {
          margin-bottom: 10px;
          padding: 8px 12px;
          border-radius: 4px;
          background-color: #252526;
          color: #e0e0e0;
          font-size: 16px;
        }
    
        .chat-message:last-child {
          margin-bottom: 0;
        }
    
        /* Scrollbar styling */
        .chat-messages::-webkit-scrollbar {
          width: 8px;
        }
    
        .chat-messages::-webkit-scrollbar-track {
          background: #1e1e1e;
        }
    
        .chat-messages::-webkit-scrollbar-thumb {
          background: #4A4A4A;
          border-radius: 4px;
          border: 2px solid #1e1e1e;
        }
    
        .chat-messages::-webkit-scrollbar-thumb:hover {
          background: #6c6c6c;
        }
	</style>
	<script>
		const Mode = {
		  RESEARCH: 0,
		  NORMAL: 1,
		  SEARCH: 2,
		  CODE: 3,
		  FASTCODE: 4
		};
		const changeMode = (mode) => {
			  const formData = new FormData();
			  formData.append("mode", mode)
			  fetch("/change-mode", {
				  method: "POST",
				  body: formData
			  })
				  .then(response => response.text())
				  .then(data => {
					  document.getElementById("mode-indicator").innerHTML = data;
				  })
				  .catch(error => {
					console.error('Error:', error);
				  });
		}
		document.addEventListener('keydown', function(event) {
		  if (event.altKey && (event.key === 'h' || event.key === 'H')) {
			  fetch("/get-full-memory")
				  .then(response => response.text())
				  .then(data => {
					  document.getElementById("chat-area").innerHTML = data;
					  PR.prettyPrint();
				  })
				  .catch(error => {
					console.error('Error:', error);
				  });
		  }
		  if (event.altKey && (event.key === 'r' || event.key === 'R')) {
			changeMode(Mode.RESEARCH);
		  }
		  if (event.altKey && (event.key === 'n' || event.key === 'N')) {
			changeMode(Mode.NORMAL);
		  }
		  if (event.altKey && (event.key === 's' || event.key === 'S')) {
			changeMode(Mode.SEARCH);
		  }
		  if (event.altKey && (event.key === 'c' || event.key === 'C')) {
			changeMode(Mode.CODE);
		  }
		  if (event.altKey && (event.key === 'f' || event.key === 'F')) {
			changeMode(Mode.FASTCODE);
		  }
		});
	</script>
</head>
<body>

	<div class="container mt-5">
		<h1 class="text-3xl font-bold text-center">Just YAAP It</h1>

		<div class="chat-container">
			<div id="chat-area" class="chat-area p-4 fs-6">
				{{.answer}}
			</div>

			<form class="chat-form" action="/" method="POST">
				<div id="mode-indicator">{{.mode}}</div>
				<input name="value" type="text" class="chat-input w-full p-2 rounded-md border border-gray-600" placeholder="Type your message..." autofocus>
				<button type="submit" class="chat-send">Send</button>
			</form>
		</div>
	</div>
</body>
</html>

